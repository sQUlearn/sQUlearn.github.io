<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Error Mitigation for Quantum Neural Networks on IBM Quantum Devices &mdash; sQUlearn 0.8.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
      <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css?v=572af1d6" />
      <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=a63e3025" />

  
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="canonical" href="https://squlearn.github.io/examples/example_qnn_backend_mitigation.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=dbee5847"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/thebelab-helper.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Solving a First-order Ordinary Differential Equation (ODE)" href="example_qnn_ode_solver.html" />
    <link rel="prev" title="Bayesian Optimization using a Quantum Gaussian Process Surrogate Model" href="example_quantum_bayesian_optimization.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.8.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/user_guide_index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/classes.html">API Reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="examples_index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="example_kernel_digit_classification.html">Handwritten Digit Recognition with Projected Quantum Kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_kernel_grid_search.html">Hyperparameter Optimization and Pipelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_quantum_bayesian_optimization.html">Bayesian Optimization using a Quantum Gaussian Process Surrogate Model</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Error Mitigation for Quantum Neural Networks on IBM Quantum Devices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Library-Imports">Library Imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Set-up-of-the-QNN">Set-up of the QNN</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Configuring-the-Quantum-Neural-Network-(QNN)">Configuring the Quantum Neural Network (QNN)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Training-of-the-QNN-with-a-noise-free-simulator">Training of the QNN with a noise free simulator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Evaluating-the-QNN-on-the-IBM-Backend-with-Error-Mitigation">Evaluating the QNN on the IBM Backend with Error Mitigation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Without-Error-Mitigation">Without Error Mitigation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Dynamic-Decoupling-and-TREX">Dynamic Decoupling and TREX</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Dynamic-Decoupling-and-Zero-Noise-Extrapolation-(ZNE)-for-Error-Mitigation">Dynamic Decoupling and Zero-Noise Extrapolation (ZNE) for Error Mitigation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Assessing-the-QNN-on-IBM-Quantum-Using-the-Sampler-Primitive">Assessing the QNN on IBM Quantum Using the Sampler Primitive</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="example_qnn_ode_solver.html">Solving a First-order Ordinary Differential Equation (ODE)</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">sQUlearn</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="examples_index.html">Examples</a></li>
      <li class="breadcrumb-item active">Error Mitigation for Quantum Neural Networks on IBM Quantum Devices</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/examples/example_qnn_backend_mitigation.nblink.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Error-Mitigation-for-Quantum-Neural-Networks-on-IBM-Quantum-Devices">
<h1>Error Mitigation for Quantum Neural Networks on IBM Quantum Devices<a class="headerlink" href="#Error-Mitigation-for-Quantum-Neural-Networks-on-IBM-Quantum-Devices" title="Link to this heading"></a></h1>
<section id="Overview">
<h2>Overview<a class="headerlink" href="#Overview" title="Link to this heading"></a></h2>
<p>This tutorial covers the setup and implementation of error mitigation techniques for Qiskit’s primitives when building Quantum Neural Networks (QNNs) using <strong>sQUlearn</strong>. We will first train a simple QNN on a noise-free, ideal simulator to fit a parabolic dataset. Next, we’ll demonstrate how to configure the <code class="docutils literal notranslate"><span class="pre">Executor</span></code> class to connect to IBM Quantum devices. Before proceeding, ensure you have an IBM Quantum account with access to IBM devices. If needed, refer to <a class="reference external" href="https://docs.quantum.ibm.com/guides/setup-channel">IBM Quantum Account
Management</a> for guidance on registering and configuring your account.</p>
<p>Due to the longer queuing times and associated costs of running circuits on real quantum hardware, we suggest using this notebook primarily as a demonstration of error mitigation setup rather than executing it directly on IBM devices. However, it will prepare you to set up error mitigation for real experiments should the need arise.</p>
<p>In this notebook, we will explore various error mitigation strategies for the <code class="docutils literal notranslate"><span class="pre">EstimatorV2</span></code> and <code class="docutils literal notranslate"><span class="pre">SamplerV2</span></code> primitive used to performe calculations on IBM Quantum.</p>
</section>
<section id="Library-Imports">
<h2>Library Imports<a class="headerlink" href="#Library-Imports" title="Link to this heading"></a></h2>
<p>To begin, we’ll import the essential libraries for this tutorial. These include <code class="docutils literal notranslate"><span class="pre">qiskit-ibm-runtime</span></code> for connecting to IBM Quantum devices. We’ll also use the <code class="docutils literal notranslate"><span class="pre">squlearn</span></code> library to build and train the QNN for both ideal and mitigated scenarios.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">qiskit_ibm_runtime</span> <span class="kn">import</span> <span class="n">QiskitRuntimeService</span><span class="p">,</span> <span class="n">Session</span>
<span class="kn">from</span> <span class="nn">qiskit_ibm_runtime.fake_provider</span> <span class="kn">import</span> <span class="n">FakeBelemV2</span>

<span class="kn">from</span> <span class="nn">squlearn</span> <span class="kn">import</span> <span class="n">Executor</span>
<span class="kn">from</span> <span class="nn">squlearn.encoding_circuit</span> <span class="kn">import</span> <span class="n">ChebyshevPQC</span>
<span class="kn">from</span> <span class="nn">squlearn.observables</span> <span class="kn">import</span> <span class="n">SummedPaulis</span>
<span class="kn">from</span> <span class="nn">squlearn.qnn</span> <span class="kn">import</span> <span class="n">QNNRegressor</span><span class="p">,</span> <span class="n">SquaredLoss</span>
<span class="kn">from</span> <span class="nn">squlearn.optimizers</span> <span class="kn">import</span> <span class="n">Adam</span>
</pre></div>
</div>
</div>
</section>
<section id="Set-up-of-the-QNN">
<h2>Set-up of the QNN<a class="headerlink" href="#Set-up-of-the-QNN" title="Link to this heading"></a></h2>
<p>We first set up the data encoding circuit for the QNN. Here, we utilize the <code class="docutils literal notranslate"><span class="pre">ChebyshevPQC</span></code> encoding circuit with 2 qubits and 2 layers to keep runtime low.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nqubits</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">pqc</span> <span class="o">=</span> <span class="n">ChebyshevPQC</span><span class="p">(</span><span class="n">num_qubits</span><span class="o">=</span><span class="n">nqubits</span><span class="p">,</span> <span class="n">num_features</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_layers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pqc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s2">&quot;mpl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_example_qnn_backend_mitigation_3_0.png" src="../_images/examples_example_qnn_backend_mitigation_3_0.png" />
</div>
</div>
<p>We utilize the parameterized summation over Z Pauli matrices as the observable: <span class="math notranslate nohighlight">\(\hat{O} = \hat{I}\alpha + \sum_i\hat{Z}_i \beta_i\)</span></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">op</span> <span class="o">=</span> <span class="n">SummedPaulis</span><span class="p">(</span><span class="n">nqubits</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SparsePauliOp([&#39;II&#39;, &#39;IZ&#39;, &#39;ZI&#39;],
              coeffs=[ParameterExpression(1.0*p[0]), ParameterExpression(1.0*p[1]),
 ParameterExpression(1.0*p[2])])
</pre></div></div>
</div>
<section id="Configuring-the-Quantum-Neural-Network-(QNN)">
<h3>Configuring the Quantum Neural Network (QNN)<a class="headerlink" href="#Configuring-the-Quantum-Neural-Network-(QNN)" title="Link to this heading"></a></h3>
<p>Lastly, we configure the Quantum Neural Network (QNN) using the <code class="docutils literal notranslate"><span class="pre">QNNRegressor</span></code> class from the <strong>squlearn</strong> library. In this setup, we initialize the QNN with randomized weights, apply the L2 Loss (also known as Squared Loss), and utilize the Adam optimization routine with a learning rate of 0.1. Notably, during training, the QNN operates on a noise-free simulation based on the <strong>PennyLane</strong> framework.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Randomly initialize parameters of the QNN</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="n">param_ini</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">pqc</span><span class="o">.</span><span class="n">num_parameters</span><span class="p">)</span>
<span class="n">param_op_ini</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">num_parameters</span><span class="p">)</span>

<span class="n">qnn_simulator</span> <span class="o">=</span> <span class="n">QNNRegressor</span><span class="p">(</span>
    <span class="n">pqc</span><span class="p">,</span>
    <span class="n">op</span><span class="p">,</span>
    <span class="n">Executor</span><span class="p">(),</span>
    <span class="n">SquaredLoss</span><span class="p">(),</span>
    <span class="n">Adam</span><span class="p">({</span><span class="s2">&quot;lr&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s2">&quot;maxiter&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}),</span>
    <span class="n">param_ini</span><span class="p">,</span>
    <span class="n">param_op_ini</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Training-of-the-QNN-with-a-noise-free-simulator">
<h2>Training of the QNN with a noise free simulator<a class="headerlink" href="#Training-of-the-QNN-with-a-noise-free-simulator" title="Link to this heading"></a></h2>
<p>In this cell, we set-up the data <code class="docutils literal notranslate"><span class="pre">x_train</span></code> and <code class="docutils literal notranslate"><span class="pre">y_train</span></code> for training the QNN. The values are obtained by calculating the values of the simple parametric function <span class="math notranslate nohighlight">\(f(x) = x^2\)</span> with the <code class="docutils literal notranslate"><span class="pre">square</span></code> function of <code class="docutils literal notranslate"><span class="pre">numpy</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data that is inputted to the QNN</span>
<span class="n">x_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="c1"># Data that is fitted by the QNN</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Afterwards, we train the QNN by calling the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method of the <code class="docutils literal notranslate"><span class="pre">QNNRegressor</span></code> class.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qnn_simulator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
fit: 100%|██████████| 100/100 [00:09&lt;00:00, 10.22it/s]
</pre></div></div>
</div>
<p>The finial parameters of the encoding circuit and the observable are displayed in the output of the following cell.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result encoding parameters:&quot;</span><span class="p">,</span> <span class="n">qnn_simulator</span><span class="o">.</span><span class="n">param</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result observable parameters:&quot;</span><span class="p">,</span> <span class="n">qnn_simulator</span><span class="o">.</span><span class="n">param_op</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Result encoding parameters: [1.65135232 0.66524017 0.94685078 0.96012197 1.07676122 0.50876202
 0.97004195 0.64628971 0.84914015 0.66567045]
Result observable parameters: [0.94664274 0.41717632 0.89088529]
</pre></div></div>
</div>
<p>Following the QNN’s training, we proceed to compute model inferences and visualize the results. The QNN model generates the parabolic output, affirming the successful training of the QNN.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x_train</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">qnn_simulator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># function for evaluating the prediction of the QNN</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Parabola function&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;QNN inference&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;training data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;QNN inference of a parabola function&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_example_qnn_backend_mitigation_15_0.png" src="../_images/examples_example_qnn_backend_mitigation_15_0.png" />
</div>
</div>
</section>
<section id="Evaluating-the-QNN-on-the-IBM-Backend-with-Error-Mitigation">
<h2>Evaluating the QNN on the IBM Backend with Error Mitigation<a class="headerlink" href="#Evaluating-the-QNN-on-the-IBM-Backend-with-Error-Mitigation" title="Link to this heading"></a></h2>
<p>Next, we assess the QNN’s performance on real IBM backends by utilizing the Qiskit runtime environment. Here, we assume an IBM Quantum setup is already configured, allowing <code class="docutils literal notranslate"><span class="pre">QiskitRuntimeService</span></code> to be called without requiring a token. We initiate a session that is shared across different executor instances to ensure that all evaluations in this notebook are executed within a single session, thereby avoiding queuing delays.</p>
<p>By default, this notebook is configured to use a fake backend to prevent incurring costs on IBM Quantum. Note, however, that error mitigation strategies are automatically disabled by Qiskit when running on a local simulator. The results presented here are based on actual IBM Quantum hardware outcomes.</p>
<p>To switch from local simulation to execution on IBM Quantum, simply set the <code class="docutils literal notranslate"><span class="pre">local</span></code> variable to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">local</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">if</span> <span class="n">local</span><span class="p">:</span>
    <span class="n">execution</span> <span class="o">=</span> <span class="n">FakeBelemV2</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">service</span> <span class="o">=</span> <span class="n">QiskitRuntimeService</span><span class="p">()</span>
    <span class="n">backend</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">least_busy</span><span class="p">(</span><span class="n">operational</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">simulator</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Selected Backend:&quot;</span><span class="p">,</span> <span class="n">backend</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">execution</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Selected Backend: ibm_strasbourg
</pre></div></div>
</div>
</section>
<section id="Without-Error-Mitigation">
<h2>Without Error Mitigation<a class="headerlink" href="#Without-Error-Mitigation" title="Link to this heading"></a></h2>
<p>In our first example, we disable all error mitigation techniques and test the QNN on the IBM backend. Here, we observe that the QNN’s output differs noticeably from the output of the noise-free simulator.</p>
<p>Primarily, the QNN’s output is no longer smooth; it displays zigzag patterns. This is because the QNN is evaluated with a limited number of shots, introducing sampling noise into each QNN output. Additionally, the shape of the QNN function changes, as if an offset has been added. Upon closer inspection, we find that this offset is not consistent.</p>
<p>These differences occur because the applied quantum gates are imperfect; their inherent error rates affect the QNN’s overall shape. A notable way to mitigate this issue is by training the QNN directly on the same IBM backend used for evaluation!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">executor_no_mitigation</span> <span class="o">=</span> <span class="n">Executor</span><span class="p">(</span><span class="n">execution</span><span class="p">,</span> <span class="n">log_file</span><span class="o">=</span><span class="s2">&quot;qnn.log&quot;</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="n">qnn_backend</span> <span class="o">=</span> <span class="n">QNNRegressor</span><span class="p">(</span>
    <span class="n">pqc</span><span class="p">,</span>
    <span class="n">op</span><span class="p">,</span>
    <span class="n">executor_no_mitigation</span><span class="p">,</span>
    <span class="n">SquaredLoss</span><span class="p">(),</span>
    <span class="n">Adam</span><span class="p">(),</span>
    <span class="n">qnn_simulator</span><span class="o">.</span><span class="n">param</span><span class="p">,</span>
    <span class="n">qnn_simulator</span><span class="o">.</span><span class="n">param_op</span><span class="p">,</span>
    <span class="n">caching</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">primitive</span><span class="o">=</span><span class="s2">&quot;estimator&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x_train</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">qnn_backend</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Parabola function&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;QNN inference&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;training data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;QNN inference without error mitigation&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_example_qnn_backend_mitigation_19_0.png" src="../_images/examples_example_qnn_backend_mitigation_19_0.png" />
</div>
</div>
</section>
<section id="Dynamic-Decoupling-and-TREX">
<h2>Dynamic Decoupling and TREX<a class="headerlink" href="#Dynamic-Decoupling-and-TREX" title="Link to this heading"></a></h2>
<p>In this example, we demonstrate how to use Dynamic Decoupling and Twirled Readout Error Extinction (TREX) to enhance QNN performance on noisy hardware. The options for error mitigation can be configured through the <code class="docutils literal notranslate"><span class="pre">estimator_options</span></code> in the executor, which allows customization of the settings for the <code class="docutils literal notranslate"><span class="pre">EstimatorV2</span></code> primitive used by squlearn under the hood.</p>
<p><strong>Dynamic Decoupling</strong> is a technique that applies carefully timed sequences of pulses to reduce errors caused by environmental noise and gate imperfections during idle times on qubits.</p>
<p><strong>TREX (Twirled Readout Error Extinction)</strong> is a method that reduces readout errors by applying randomized transformations to measurement outcomes, making the errors more uniform and thus easier to correct.</p>
<p>More details on various error mitigation and suppression strategies are available in the <a class="reference external" href="https://docs.quantum.ibm.com/guides/error-mitigation-and-suppression-techniques">Qiskit documentation</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">executor_dd_trex</span> <span class="o">=</span> <span class="n">Executor</span><span class="p">(</span><span class="n">execution</span><span class="p">,</span> <span class="n">log_file</span><span class="o">=</span><span class="s2">&quot;qnn.log&quot;</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="c1"># Dynamical decoupling</span>
<span class="n">executor_dd_trex</span><span class="o">.</span><span class="n">estimator_options</span><span class="o">.</span><span class="n">dynamical_decoupling</span><span class="o">.</span><span class="n">enable</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">executor_dd_trex</span><span class="o">.</span><span class="n">estimator_options</span><span class="o">.</span><span class="n">dynamical_decoupling</span><span class="o">.</span><span class="n">sequence_type</span> <span class="o">=</span> <span class="s2">&quot;XpXm&quot;</span>

<span class="c1"># Twirled readout error extinction (TREX)</span>
<span class="n">executor_dd_trex</span><span class="o">.</span><span class="n">estimator_options</span><span class="o">.</span><span class="n">resilience</span><span class="o">.</span><span class="n">measure_mitigation</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">executor_dd_trex</span><span class="o">.</span><span class="n">estimator_options</span><span class="o">.</span><span class="n">resilience</span><span class="o">.</span><span class="n">measure_noise_learning</span><span class="o">.</span><span class="n">num_randomizations</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">executor_dd_trex</span><span class="o">.</span><span class="n">estimator_options</span><span class="o">.</span><span class="n">resilience</span><span class="o">.</span><span class="n">measure_noise_learning</span><span class="o">.</span><span class="n">shots_per_randomization</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">qnn_backend</span> <span class="o">=</span> <span class="n">QNNRegressor</span><span class="p">(</span>
    <span class="n">pqc</span><span class="p">,</span>
    <span class="n">op</span><span class="p">,</span>
    <span class="n">executor_dd_trex</span><span class="p">,</span>
    <span class="n">SquaredLoss</span><span class="p">(),</span>
    <span class="n">Adam</span><span class="p">(),</span>
    <span class="n">qnn_simulator</span><span class="o">.</span><span class="n">param</span><span class="p">,</span>
    <span class="n">qnn_simulator</span><span class="o">.</span><span class="n">param_op</span><span class="p">,</span>
    <span class="n">caching</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">primitive</span><span class="o">=</span><span class="s2">&quot;estimator&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">qnn_backend</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Parabola function&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;QNN inference&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;training data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;QNN inference without dynamic decoupling and TREX&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_example_qnn_backend_mitigation_21_0.png" src="../_images/examples_example_qnn_backend_mitigation_21_0.png" />
</div>
</div>
<section id="Dynamic-Decoupling-and-Zero-Noise-Extrapolation-(ZNE)-for-Error-Mitigation">
<h3>Dynamic Decoupling and Zero-Noise Extrapolation (ZNE) for Error Mitigation<a class="headerlink" href="#Dynamic-Decoupling-and-Zero-Noise-Extrapolation-(ZNE)-for-Error-Mitigation" title="Link to this heading"></a></h3>
<p>In this example, we employ Zero-Noise Extrapolation (ZNE) to mitigate errors in the computed expectation values. ZNE works by running quantum circuits with artificially increased noise levels and then extrapolating the results to approximate a noise-free scenario.</p>
<p>Qiskit’s implementation of zero-noise extrapolation offers various options for fine-tuning the error mitigation process. For more details, refer to the <a class="reference external" href="https://docs.quantum.ibm.com/api/qiskit-ibm-runtime/qiskit_ibm_runtime.options.ZneOptions">Qiskit documentation on ZNE</a>.</p>
<p>In this case, ZNE did not perfectly align the QNN’s output with the noise-free results, though it brought the QNN’s output shape closer to that of the noise-free simulator. However, it’s worth noting that the noise levels increased due to the extrapolation steps involved in ZNE.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">executor_zne</span> <span class="o">=</span> <span class="n">Executor</span><span class="p">(</span><span class="n">execution</span><span class="p">,</span> <span class="n">log_file</span><span class="o">=</span><span class="s2">&quot;qnn.log&quot;</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="c1"># Configuration for Zero Noise Extrapolation</span>
<span class="n">executor_zne</span><span class="o">.</span><span class="n">estimator_options</span><span class="o">.</span><span class="n">resilience</span><span class="o">.</span><span class="n">zne_mitigation</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">executor_zne</span><span class="o">.</span><span class="n">estimator_options</span><span class="o">.</span><span class="n">resilience</span><span class="o">.</span><span class="n">zne</span><span class="o">.</span><span class="n">noise_factors</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">executor_zne</span><span class="o">.</span><span class="n">estimator_options</span><span class="o">.</span><span class="n">resilience</span><span class="o">.</span><span class="n">zne</span><span class="o">.</span><span class="n">extrapolator</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span>

<span class="n">qnn_backend</span> <span class="o">=</span> <span class="n">QNNRegressor</span><span class="p">(</span>
    <span class="n">pqc</span><span class="p">,</span>
    <span class="n">op</span><span class="p">,</span>
    <span class="n">executor_zne</span><span class="p">,</span>
    <span class="n">SquaredLoss</span><span class="p">(),</span>
    <span class="n">Adam</span><span class="p">(),</span>
    <span class="n">qnn_simulator</span><span class="o">.</span><span class="n">param</span><span class="p">,</span>
    <span class="n">qnn_simulator</span><span class="o">.</span><span class="n">param_op</span><span class="p">,</span>
    <span class="n">caching</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">primitive</span><span class="o">=</span><span class="s2">&quot;estimator&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">qnn_backend</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Parabola function&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;QNN inference&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;training data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;QNN inference with ZNE&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_example_qnn_backend_mitigation_23_0.png" src="../_images/examples_example_qnn_backend_mitigation_23_0.png" />
</div>
</div>
</section>
</section>
<section id="Assessing-the-QNN-on-IBM-Quantum-Using-the-Sampler-Primitive">
<h2>Assessing the QNN on IBM Quantum Using the Sampler Primitive<a class="headerlink" href="#Assessing-the-QNN-on-IBM-Quantum-Using-the-Sampler-Primitive" title="Link to this heading"></a></h2>
<p>Last, we assess the QNN’s performance by utilizing the Sampler primitive. The Sampler primitive gathers probability distributions from the encoding circuits, allowing the QNN to compute expectation values of observables based on these probabilities.</p>
<p>The Sampler primitive also supports various error mitigation strategies, which can be configured in the <code class="docutils literal notranslate"><span class="pre">Executor</span></code> via <code class="docutils literal notranslate"><span class="pre">sampler_options</span></code>, similar to the <code class="docutils literal notranslate"><span class="pre">estimator_options</span></code> discussed above.</p>
<p>In this example, we again apply Dynamic Decoupling as an error mitigation technique and ensure the QNN uses the Sampler primitive by specifying <code class="docutils literal notranslate"><span class="pre">primitive=&quot;sampler&quot;</span></code> during QNN initialization.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">executor_sampler</span> <span class="o">=</span> <span class="n">Executor</span><span class="p">(</span><span class="n">execution</span><span class="p">,</span> <span class="n">log_file</span><span class="o">=</span><span class="s2">&quot;qnn.log&quot;</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="n">executor_sampler</span><span class="o">.</span><span class="n">sampler_options</span><span class="o">.</span><span class="n">dynamical_decoupling</span><span class="o">.</span><span class="n">enable</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">executor_sampler</span><span class="o">.</span><span class="n">sampler_options</span><span class="o">.</span><span class="n">dynamical_decoupling</span><span class="o">.</span><span class="n">sequence_type</span> <span class="o">=</span> <span class="s2">&quot;XpXm&quot;</span>

<span class="n">qnn_backend</span> <span class="o">=</span> <span class="n">QNNRegressor</span><span class="p">(</span>
    <span class="n">pqc</span><span class="p">,</span>
    <span class="n">op</span><span class="p">,</span>
    <span class="n">executor_sampler</span><span class="p">,</span>
    <span class="n">SquaredLoss</span><span class="p">(),</span>
    <span class="n">Adam</span><span class="p">(),</span>
    <span class="n">qnn_simulator</span><span class="o">.</span><span class="n">param</span><span class="p">,</span>
    <span class="n">qnn_simulator</span><span class="o">.</span><span class="n">param_op</span><span class="p">,</span>
    <span class="n">caching</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">primitive</span><span class="o">=</span><span class="s2">&quot;sampler&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">qnn_backend</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Parabola function&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;QNN inference&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;training data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;QNN inference utilizing Sampler and with DD mitigation&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_example_qnn_backend_mitigation_25_0.png" src="../_images/examples_example_qnn_backend_mitigation_25_0.png" />
</div>
</div>
<p>In the last step, we manually close the session in order to terminate the (potentially costly) usage of the quantum computing resource.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">execution</span><span class="p">,</span> <span class="n">Session</span><span class="p">):</span>
    <span class="n">execution</span><span class="o">.</span><span class="n">close_session</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="example_quantum_bayesian_optimization.html" class="btn btn-neutral float-left" title="Bayesian Optimization using a Quantum Gaussian Process Surrogate Model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="example_qnn_ode_solver.html" class="btn btn-neutral float-right" title="Solving a First-order Ordinary Differential Equation (ODE)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Fraunhofer IPA.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>