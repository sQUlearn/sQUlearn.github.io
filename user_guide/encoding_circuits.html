<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quantum Encoding Circuits &mdash; sQUlearn 0.10.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
      <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css?v=572af1d6" />
      <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=a63e3025" />

  
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="canonical" href="https://squlearn.github.io/user_guide/encoding_circuits.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=82662543"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/thebelab-helper.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Quantum Kernel Methods" href="kernel_methods.html" />
    <link rel="prev" title="Observables for expectation values" href="observables.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.10.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install/install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="user_guide_index.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="executor.html">The Executor Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="observables.html">Observables for expectation values</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Quantum Encoding Circuits</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#implemented-quantum-encoding-circuits">Implemented Quantum Encoding Circuits</a></li>
<li class="toctree-l3"><a class="reference internal" href="#combining-quantum-encoding-circuits">Combining Quantum Encoding Circuits</a></li>
<li class="toctree-l3"><a class="reference internal" href="#wrapping-qiskit-encoding-circuits">Wrapping Qiskit Encoding Circuits</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-your-custom-encoding-circuit-via-layeredencodingcircuit">Create your custom Encoding Circuit via <code class="xref py py-class docutils literal notranslate"><span class="pre">LayeredEncodingCircuit</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pruning-of-quantum-encoding-circuits">Pruning of Quantum Encoding Circuits</a></li>
<li class="toctree-l3"><a class="reference internal" href="#different-quantum-encoding-circuits-via-encodingcircuitderivatives">Different Quantum Encoding Circuits via <code class="xref py py-class docutils literal notranslate"><span class="pre">EncodingCircuitDerivatives</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#transpile-quantum-encoding-circuits-via-transpiledencodingcircuit">Transpile Quantum Encoding Circuits via <code class="xref py py-class docutils literal notranslate"><span class="pre">TranspiledEncodingCircuit</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="kernel_methods.html">Quantum Kernel Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="quantum_neural_networks.html">Quantum Neural Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="quantum_reservoir_computing.html">Quantum Reservoir Computing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules/classes.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/examples_index.html">Examples</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">sQUlearn</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="user_guide_index.html">User Guide</a></li>
      <li class="breadcrumb-item active">Quantum Encoding Circuits</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/user_guide/encoding_circuits.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="quantum-encoding-circuits">
<span id="id1"></span><h1>Quantum Encoding Circuits<a class="headerlink" href="#quantum-encoding-circuits" title="Link to this heading"></a></h1>
<p>Quantum encoding circuits are used to embed classical data <span class="math notranslate nohighlight">\(x\)</span> into a quantum state and manipulate
the quantum state via trainable parameters <span class="math notranslate nohighlight">\(p\)</span>.
They are a key component of many quantum machine learning algorithms, and the design of a good
quantum encoding circuit is crucial for the performance of the algorithm.
In sQUlearn, encoding circuits are an obligatory input in the Quantum Neural Network (QNN) or Quantum
Kernel programs.
sQUlearn offers a wide range of pre-implemented quantum encoding circuits,
which can be combined to create more sophisticated encoding circuits.
Furthermore, it is possible to create custom encoding circuits that follow a layered approach, in which
each gate is applied to all qubits.
The package facilitate a fully automated pruning algorithm to remove redundant parameters and
enables the automatic differentiation of arbitrary derivative.</p>
<p>The following functions and classes are accessible via <a class="reference internal" href="../modules/classes.html#module-squlearn.encoding_circuit" title="squlearn.encoding_circuit"><code class="xref py py-class docutils literal notranslate"><span class="pre">squlearn.encoding_circuit</span></code></a>.</p>
<section id="implemented-quantum-encoding-circuits">
<h2>Implemented Quantum Encoding Circuits<a class="headerlink" href="#implemented-quantum-encoding-circuits" title="Link to this heading"></a></h2>
<p>There are several Quantum Encoding Circuits implemented in sQUlearn:</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../modules/generated/squlearn.encoding_circuit.YZ_CX_EncodingCircuit.html#squlearn.encoding_circuit.YZ_CX_EncodingCircuit" title="squlearn.encoding_circuit.YZ_CX_EncodingCircuit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">YZ_CX_EncodingCircuit</span></code></a></p></td>
<td><p>Creates the YZ-CX Encoding Circuit from reference [1].</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../modules/generated/squlearn.encoding_circuit.HighDimEncodingCircuit.html#squlearn.encoding_circuit.HighDimEncodingCircuit" title="squlearn.encoding_circuit.HighDimEncodingCircuit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HighDimEncodingCircuit</span></code></a></p></td>
<td><p>The high-dimensional encoding circuit from reference [1].</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../modules/generated/squlearn.encoding_circuit.HubregtsenEncodingCircuit.html#squlearn.encoding_circuit.HubregtsenEncodingCircuit" title="squlearn.encoding_circuit.HubregtsenEncodingCircuit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HubregtsenEncodingCircuit</span></code></a></p></td>
<td><p>Creates the data reuploading encoding circuit as presented in reference [1].</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../modules/generated/squlearn.encoding_circuit.ChebyshevTower.html#squlearn.encoding_circuit.ChebyshevTower" title="squlearn.encoding_circuit.ChebyshevTower"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ChebyshevTower</span></code></a></p></td>
<td><p>A feature-map that is based on the Chebyshev Tower encoding.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../modules/generated/squlearn.encoding_circuit.ChebyshevPQC.html#squlearn.encoding_circuit.ChebyshevPQC" title="squlearn.encoding_circuit.ChebyshevPQC"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ChebyshevPQC</span></code></a></p></td>
<td><p>Chebyshev Encoding Circuit from reference [1].</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../modules/generated/squlearn.encoding_circuit.MultiControlEncodingCircuit.html#squlearn.encoding_circuit.MultiControlEncodingCircuit" title="squlearn.encoding_circuit.MultiControlEncodingCircuit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MultiControlEncodingCircuit</span></code></a></p></td>
<td><p>Encoding circuit with HZ encoding followed by controlled Rx, Ry Rz rotations.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../modules/generated/squlearn.encoding_circuit.ChebyshevRx.html#squlearn.encoding_circuit.ChebyshevRx" title="squlearn.encoding_circuit.ChebyshevRx"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ChebyshevRx</span></code></a></p></td>
<td><p>Simple Chebyshev encoding circuit build from  Rx gates</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../modules/generated/squlearn.encoding_circuit.ParamZFeatureMap.html#squlearn.encoding_circuit.ParamZFeatureMap" title="squlearn.encoding_circuit.ParamZFeatureMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ParamZFeatureMap</span></code></a></p></td>
<td><p>Parameterized Z feature map  with optional CNOT gates between the default layers.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../modules/generated/squlearn.encoding_circuit.QiskitEncodingCircuit.html#squlearn.encoding_circuit.QiskitEncodingCircuit" title="squlearn.encoding_circuit.QiskitEncodingCircuit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">QiskitEncodingCircuit</span></code></a></p></td>
<td><p>Wrapper to create sQUlearn encoding circuits from the <a class="reference external" href="https://qiskit.org/documentation/apidoc/circuit_library.html">Qiskit circuit library</a>.</p></td>
</tr>
</tbody>
</table>
<p>Feel free to contribute to sQUlearn by adding your own encoding circuits in a Pull Request.</p>
<p><strong>Example: Create a Hubregtsen encoding circuit</strong></p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">squlearn.encoding_circuit</span> <span class="kn">import</span> <span class="n">HubregtsenEncodingCircuit</span>
<span class="n">pqc</span> <span class="o">=</span> <span class="n">HubregtsenEncodingCircuit</span><span class="p">(</span><span class="n">num_qubits</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">num_layers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pqc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;mpl&quot;</span><span class="p">,</span> <span class="n">num_features</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/encoding_circuits_0_0.png" src="../_images/encoding_circuits_0_0.png" />
</div>
</div>
</section>
<section id="combining-quantum-encoding-circuits">
<h2>Combining Quantum Encoding Circuits<a class="headerlink" href="#combining-quantum-encoding-circuits" title="Link to this heading"></a></h2>
<p>In sQUlearn, quantum encoding circuits can be combined to create more sophisticated encoding circuits by
utilizing the <code class="docutils literal notranslate"><span class="pre">+</span></code> operation between two encoding circuits. However, it is important to note that
the number of qubits in both encoding circuits must match for successful combination.</p>
<p>When combining encoding circuits, the resulting feature dimension is determined by taking the maximum
value from the two feature dimensions. The parameters of the individual encoding circuits are
concatenated. Consequently, the total number of parameters in the combined encoding circuit is
equal to the sum of the parameters in the two original encoding circuits.</p>
<p><strong>Example: combine two quantum encoding circuits</strong></p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">squlearn.encoding_circuit</span> <span class="kn">import</span> <span class="n">HubregtsenEncodingCircuit</span><span class="p">,</span> <span class="n">ChebyshevPQC</span>
<span class="n">fm1</span> <span class="o">=</span> <span class="n">HubregtsenEncodingCircuit</span><span class="p">(</span><span class="n">num_qubits</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">num_layers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fm2</span> <span class="o">=</span> <span class="n">ChebyshevPQC</span><span class="p">(</span><span class="n">num_qubits</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">num_layers</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Combining both encoding circuits</span>
<span class="n">fm3</span> <span class="o">=</span> <span class="n">fm1</span> <span class="o">+</span> <span class="n">fm2</span>
<span class="n">fm3</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;mpl&quot;</span><span class="p">,</span> <span class="n">num_features</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/encoding_circuits_1_0.png" src="../_images/encoding_circuits_1_0.png" />
</div>
</div>
</section>
<section id="wrapping-qiskit-encoding-circuits">
<h2>Wrapping Qiskit Encoding Circuits<a class="headerlink" href="#wrapping-qiskit-encoding-circuits" title="Link to this heading"></a></h2>
<p>It is also possible to utilize the wrapper <a class="reference internal" href="../modules/generated/squlearn.encoding_circuit.QiskitEncodingCircuit.html#squlearn.encoding_circuit.QiskitEncodingCircuit" title="squlearn.encoding_circuit.QiskitEncodingCircuit"><code class="xref py py-class docutils literal notranslate"><span class="pre">QiskitEncodingCircuit</span></code></a> to build Encoding Circuits from the
<a class="reference external" href="https://qiskit.org/documentation/apidoc/circuit_library.html">Qiskit circuit library</a>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">squlearn.encoding_circuit</span> <span class="kn">import</span> <span class="n">QiskitEncodingCircuit</span>
<span class="kn">from</span> <span class="nn">qiskit.circuit.library</span> <span class="kn">import</span> <span class="n">TwoLocal</span>
<span class="n">local</span> <span class="o">=</span> <span class="n">TwoLocal</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;ry&#39;</span><span class="p">,</span> <span class="s1">&#39;cx&#39;</span><span class="p">,</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">insert_barriers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">QiskitEncodingCircuit</span><span class="p">(</span><span class="n">local</span><span class="p">)</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;mpl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/encoding_circuits_2_0.png" src="../_images/encoding_circuits_2_0.png" />
</div>
</div>
</section>
<section id="create-your-custom-encoding-circuit-via-layeredencodingcircuit">
<h2>Create your custom Encoding Circuit via <a class="reference internal" href="../modules/generated/squlearn.encoding_circuit.LayeredEncodingCircuit.html#squlearn.encoding_circuit.LayeredEncodingCircuit" title="squlearn.encoding_circuit.LayeredEncodingCircuit"><code class="xref py py-class docutils literal notranslate"><span class="pre">LayeredEncodingCircuit</span></code></a><a class="headerlink" href="#create-your-custom-encoding-circuit-via-layeredencodingcircuit" title="Link to this heading"></a></h2>
<p>sQUlearn offers a user-friendly solution for creating custom layered encoding circuits effortlessly.
Layered encoding circuits involve the application of gates to all qubits, ensuring a comprehensive
approach. This method allows for the creation of encoding circuits in a structured manner,
regardless of the number of qubits involved.
Two-qubit gates are applied either in a nearest neighbor fashion or by entangling all qubits.
You can construct the layered encoding circuit using either a Qiskit Quantum circuit-inspired approach
or by providing a string using the
<a class="reference internal" href="../modules/generated/squlearn.encoding_circuit.LayeredEncodingCircuit.html#squlearn.encoding_circuit.LayeredEncodingCircuit.from_string" title="squlearn.encoding_circuit.LayeredEncodingCircuit.from_string"><code class="xref py py-meth docutils literal notranslate"><span class="pre">LayeredEncodingCircuit.from_string()</span></code></a>
method. For detailed instructions on the string format, please refer to the documentation of
the <a class="reference internal" href="../modules/generated/squlearn.encoding_circuit.LayeredEncodingCircuit.html#squlearn.encoding_circuit.LayeredEncodingCircuit" title="squlearn.encoding_circuit.LayeredEncodingCircuit"><code class="xref py py-class docutils literal notranslate"><span class="pre">LayeredEncodingCircuit</span></code></a> class.</p>
<p><strong>Example: Create your custom layered encoding circuit</strong></p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">squlearn.encoding_circuit</span> <span class="kn">import</span> <span class="n">LayeredEncodingCircuit</span>
<span class="kn">from</span> <span class="nn">squlearn.encoding_circuit.layered_encoding_circuit</span> <span class="kn">import</span> <span class="n">Layer</span>
<span class="n">encoding_circuit</span> <span class="o">=</span> <span class="n">LayeredEncodingCircuit</span><span class="p">(</span><span class="n">num_qubits</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">encoding_circuit</span><span class="o">.</span><span class="n">H</span><span class="p">()</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">Layer</span><span class="p">(</span><span class="n">encoding_circuit</span><span class="p">)</span>
<span class="n">layer</span><span class="o">.</span><span class="n">Rz</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">layer</span><span class="o">.</span><span class="n">Ry</span><span class="p">(</span><span class="s2">&quot;p&quot;</span><span class="p">)</span>
<span class="n">layer</span><span class="o">.</span><span class="n">cx_entangling</span><span class="p">(</span><span class="s2">&quot;NN&quot;</span><span class="p">)</span>
<span class="n">encoding_circuit</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="n">num_layers</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">encoding_circuit</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;mpl&quot;</span><span class="p">,</span> <span class="n">num_features</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/encoding_circuits_3_0.png" src="../_images/encoding_circuits_3_0.png" />
</div>
</div>
<p><strong>Example: Create your custom layered encoding circuit from a string</strong></p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">squlearn.encoding_circuit</span> <span class="kn">import</span> <span class="n">LayeredEncodingCircuit</span>
<span class="n">encoding_circuit</span> <span class="o">=</span> <span class="n">LayeredEncodingCircuit</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span>
   <span class="s2">&quot;Ry(p)-3[Rx(p,x;=y*np.arccos(x),{y,x})-crz(p)]-Ry(p)&quot;</span><span class="p">,</span> <span class="n">num_qubits</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">num_layers</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>
<span class="n">encoding_circuit</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;mpl&quot;</span><span class="p">,</span> <span class="n">num_features</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/encoding_circuits_4_0.png" src="../_images/encoding_circuits_4_0.png" />
</div>
</div>
</section>
<section id="pruning-of-quantum-encoding-circuits">
<h2>Pruning of Quantum Encoding Circuits<a class="headerlink" href="#pruning-of-quantum-encoding-circuits" title="Link to this heading"></a></h2>
<p>It is also possible to remove parameterized gates from a quantum encoding circuit by using the
<a class="reference internal" href="../modules/generated/squlearn.encoding_circuit.PrunedEncodingCircuit.html#squlearn.encoding_circuit.PrunedEncodingCircuit" title="squlearn.encoding_circuit.PrunedEncodingCircuit"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrunedEncodingCircuit</span></code></a> class.
This class accepts a quantum encoding circuit as input and removes the parameterized gates
from the encoding circuit for the parameters which indices are specified in the supplied list.
The pruned encoding circuit automatically adjusts the number of parameters and features.</p>
<p>Furthermore it is possible to determine the redundant parameters in encoding circuit automatically.
The algorithm is based on <a class="reference external" href="https://doi.org/10.1103/PRXQuantum.2.040309">https://doi.org/10.1103/PRXQuantum.2.040309</a> and is based on evaluating
the Quantum Fisher Information Matrix (QFIM) of the encoding circuit.</p>
<p>sQUlearn features a fully automated pruning algorithm which can be used by calling the routine
<a class="reference internal" href="../modules/generated/squlearn.encoding_circuit.automated_pruning.html#squlearn.encoding_circuit.automated_pruning" title="squlearn.encoding_circuit.automated_pruning"><code class="xref py py-meth docutils literal notranslate"><span class="pre">automated_pruning()</span></code></a> that returns a pruned encoding circuit without the redundant parameters.</p>
<p><strong>Example: Pruning a encoding circuit with redundant parameters</strong></p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">squlearn.encoding_circuit</span> <span class="kn">import</span> <span class="n">LayeredEncodingCircuit</span><span class="p">,</span> <span class="n">automated_pruning</span>
<span class="kn">from</span> <span class="nn">squlearn.util</span> <span class="kn">import</span> <span class="n">Executor</span>
<span class="n">encoding_circuit</span> <span class="o">=</span> <span class="n">LayeredEncodingCircuit</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;Rz(p)-Ry(p)-Z-Ry(p)-Rz(p)&quot;</span><span class="p">,</span> <span class="n">num_qubits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_features</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">encoding_circuit</span><span class="o">.</span><span class="n">_build_layered_pqc</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">pruned_encoding_circuit</span> <span class="o">=</span> <span class="n">automated_pruning</span><span class="p">(</span><span class="n">encoding_circuit</span><span class="p">,</span> <span class="n">Executor</span><span class="p">())</span>
<span class="n">pruned_encoding_circuit</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;mpl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Pruned parameters: [0 1 2 3]
</pre></div>
</div>
<img alt="../_images/encoding_circuits_5_1.png" src="../_images/encoding_circuits_5_1.png" />
</div>
</div>
</section>
<section id="different-quantum-encoding-circuits-via-encodingcircuitderivatives">
<h2>Different Quantum Encoding Circuits via <a class="reference internal" href="../modules/generated/squlearn.encoding_circuit.EncodingCircuitDerivatives.html#squlearn.encoding_circuit.EncodingCircuitDerivatives" title="squlearn.encoding_circuit.EncodingCircuitDerivatives"><code class="xref py py-class docutils literal notranslate"><span class="pre">EncodingCircuitDerivatives</span></code></a><a class="headerlink" href="#different-quantum-encoding-circuits-via-encodingcircuitderivatives" title="Link to this heading"></a></h2>
<p>The calculation of derivatives for quantum encoding circuits is often essential in training a
Quantum Machine Learning model. In sQUlearn, we offer a straightforward approach to compute
these derivatives using the <a class="reference internal" href="../modules/generated/squlearn.encoding_circuit.EncodingCircuitDerivatives.html#squlearn.encoding_circuit.EncodingCircuitDerivatives" title="squlearn.encoding_circuit.EncodingCircuitDerivatives"><code class="xref py py-class docutils literal notranslate"><span class="pre">EncodingCircuitDerivatives</span></code></a> class.
This class accepts an existing quantum encoding circuit as input and generates derivatives of the
encoding circuit with respect to its parameters or features. The derivative circuits are generated
by leveraging the parameter-shift rule and are cached for future use.
Use the function <a class="reference internal" href="../modules/generated/squlearn.encoding_circuit.EncodingCircuitDerivatives.html#squlearn.encoding_circuit.EncodingCircuitDerivatives.get_derivative" title="squlearn.encoding_circuit.EncodingCircuitDerivatives.get_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_derivative()</span></code></a>
to obtain the derivative. There are several options to specify the derivative you want to obtain:</p>
<ol class="arabic simple">
<li><p>Provide a string that specifies the derivative you want to obtain. A list of the available
strings can be found in the documentation of the <a class="reference internal" href="../modules/generated/squlearn.encoding_circuit.EncodingCircuitDerivatives.html#squlearn.encoding_circuit.EncodingCircuitDerivatives" title="squlearn.encoding_circuit.EncodingCircuitDerivatives"><code class="xref py py-class docutils literal notranslate"><span class="pre">EncodingCircuitDerivatives</span></code></a> class.</p></li>
<li><p>Provide a tuple containing the ParameterVector or an element of the ParameterVector to
obtain higher order derivatives. The derivatives are applied successively following the order in
the tuple.</p></li>
<li><p>Provide a list of ParameterVector elements to obtain the derivatives of the specified elements.
This can also be placed in the tuple.</p></li>
</ol>
<p>The derivatives are stored in sQUlearn’s proprietary OpTree structure, which
is utilized for the arithmetic operations of the derivatives.</p>
<p><strong>Example: Obtain the derivative of a Hubregtsen encoding circuit</strong></p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">squlearn.encoding_circuit</span> <span class="kn">import</span> <span class="n">HubregtsenEncodingCircuit</span><span class="p">,</span> <span class="n">EncodingCircuitDerivatives</span>
<span class="n">fm</span> <span class="o">=</span> <span class="n">HubregtsenEncodingCircuit</span><span class="p">(</span><span class="n">num_qubits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_layers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fm_deriv</span> <span class="o">=</span> <span class="n">EncodingCircuitDerivatives</span><span class="p">(</span><span class="n">fm</span><span class="p">,</span> <span class="n">num_features</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># From String (gradient of the parameter vector)</span>
<span class="n">grad_from_string</span> <span class="o">=</span> <span class="n">fm_deriv</span><span class="o">.</span><span class="n">get_derivative</span><span class="p">(</span><span class="s2">&quot;dp&quot;</span><span class="p">)</span>
<span class="c1"># From Tuple (second order derivative of the parameter vector; equal to the Hessian)</span>
<span class="n">grad_from_tuple</span> <span class="o">=</span> <span class="n">fm_deriv</span><span class="o">.</span><span class="n">get_derivative</span><span class="p">((</span><span class="n">fm_deriv</span><span class="o">.</span><span class="n">parameter_vector</span><span class="p">,</span><span class="n">fm_deriv</span><span class="o">.</span><span class="n">parameter_vector</span><span class="p">))</span>
<span class="c1"># From List (only partial derivatives of the first two parameters)</span>
<span class="n">grad_from_List</span> <span class="o">=</span> <span class="n">fm_deriv</span><span class="o">.</span><span class="n">get_derivative</span><span class="p">(([</span><span class="n">fm_deriv</span><span class="o">.</span><span class="n">parameter_vector</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                            <span class="n">fm_deriv</span><span class="o">.</span><span class="n">parameter_vector</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                                          <span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</section>
<section id="transpile-quantum-encoding-circuits-via-transpiledencodingcircuit">
<h2>Transpile Quantum Encoding Circuits via <a class="reference internal" href="../modules/generated/squlearn.encoding_circuit.TranspiledEncodingCircuit.html#squlearn.encoding_circuit.TranspiledEncodingCircuit" title="squlearn.encoding_circuit.TranspiledEncodingCircuit"><code class="xref py py-class docutils literal notranslate"><span class="pre">TranspiledEncodingCircuit</span></code></a><a class="headerlink" href="#transpile-quantum-encoding-circuits-via-transpiledencodingcircuit" title="Link to this heading"></a></h2>
<p>To transpile a quantum encoding circuit, you can leverage the functionality provided by the
<a class="reference internal" href="../modules/generated/squlearn.encoding_circuit.TranspiledEncodingCircuit.html#squlearn.encoding_circuit.TranspiledEncodingCircuit" title="squlearn.encoding_circuit.TranspiledEncodingCircuit"><code class="xref py py-class docutils literal notranslate"><span class="pre">TranspiledEncodingCircuit</span></code></a> class. By utilizing this class, you can input an existing
quantum encoding circuit and have its circuit transpiled according to the specified backend and
transpiler settings, which are the same settings used in Qiskit.
The transpiled encoding circuit is internally employed in the QNN program and projected kernels.</p>
<p><strong>Example: Transpile a existing Encoding Circuit to a fake backend</strong></p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">squlearn.encoding_circuit</span> <span class="kn">import</span> <span class="n">TranspiledEncodingCircuit</span><span class="p">,</span><span class="n">ChebyshevRx</span>
<span class="kn">from</span> <span class="nn">qiskit_ibm_runtime.fake_provider</span> <span class="kn">import</span> <span class="n">FakeManilaV2</span>

<span class="n">fm</span> <span class="o">=</span> <span class="n">TranspiledEncodingCircuit</span><span class="p">(</span>
   <span class="n">ChebyshevRx</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
   <span class="n">backend</span><span class="o">=</span><span class="n">FakeManilaV2</span><span class="p">(),</span>
   <span class="n">num_features</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
   <span class="n">initial_layout</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">fm</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;mpl&quot;</span><span class="p">,</span> <span class="n">num_features</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/encoding_circuits_7_0.png" src="../_images/encoding_circuits_7_0.png" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="observables.html" class="btn btn-neutral float-left" title="Observables for expectation values" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="kernel_methods.html" class="btn btn-neutral float-right" title="Quantum Kernel Methods" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Fraunhofer IPA.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>