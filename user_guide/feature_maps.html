<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quantum Feature Maps &mdash; sQUlearn 0.3.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Quantum Kernel Methods" href="kernel_methods.html" />
    <link rel="prev" title="Operators for expectation values" href="operators.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            sQUlearn
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install/install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="user_guide_index.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="executor.html">The Executor Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="operators.html">Operators for expectation values</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Quantum Feature Maps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#implemented-quantum-feature-maps">Implemented Quantum Feature Maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="#combining-quantum-feature-maps">Combining Quantum Feature Maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="#wrapping-qiskit-feature-maps">Wrapping Qiskit Feature Maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-your-custom-feature-map-via-layeredfeaturemap">Create your custom Feature Map via <code class="xref py py-class docutils literal notranslate"><span class="pre">LayeredFeatureMap</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pruning-of-quantum-feature-maps">Pruning of Quantum Feature Maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="#different-quantum-feature-maps-via-featuremapderivatives">Different Quantum Feature Maps via <code class="xref py py-class docutils literal notranslate"><span class="pre">FeatureMapDerivatives</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#transpile-quantum-feature-maps-via-transpiledfeaturemap">Transpile Quantum Feature Maps via <code class="xref py py-class docutils literal notranslate"><span class="pre">TranspiledFeatureMap</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="kernel_methods.html">Quantum Kernel Methods</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules/classes.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/examples_index.html">Examples</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">sQUlearn</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="user_guide_index.html">User Guide</a></li>
      <li class="breadcrumb-item active">Quantum Feature Maps</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/user_guide/feature_maps.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="quantum-feature-maps">
<span id="id1"></span><h1>Quantum Feature Maps<a class="headerlink" href="#quantum-feature-maps" title="Permalink to this heading"></a></h1>
<p>Quantum feature maps are used to embed classical data <span class="math notranslate nohighlight">\(x\)</span> into a quantum state and manipulate
the quantum state via trainable parameters <span class="math notranslate nohighlight">\(p\)</span>.
They are a key component of many quantum machine learning algorithms, and the design of a good
quantum feature map is crucial for the performance of the algorithm.
In sQUlearn, feature maps are an obligatory input in the Quantum Neural Network (QNN) or Quantum
Kernel programs.
sQUlearn offers a wide range of pre-implemented quantum feature maps,
which can be combined to create more sophisticated feature maps.
Furthermore, it is possible to create custom feature maps that follow a layered approach, in which
each gate is applied to all qubits.
The package facilitate a fully automated pruning algorithm to remove redundant parameters and
enables the automatic differentiation of arbitrary derivative.</p>
<p>The following functions and classes are are accessible via <a class="reference internal" href="../modules/classes.html#module-squlearn.feature_map" title="squlearn.feature_map"><code class="xref py py-class docutils literal notranslate"><span class="pre">squlearn.feature_map</span></code></a>.</p>
<section id="implemented-quantum-feature-maps">
<h2>Implemented Quantum Feature Maps<a class="headerlink" href="#implemented-quantum-feature-maps" title="Permalink to this heading"></a></h2>
<p>There are several Quantum Feature Maps implemented in sQUlearn:</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../modules/generated/squlearn.feature_map.YZ_CX_FeatureMap.html#squlearn.feature_map.YZ_CX_FeatureMap" title="squlearn.feature_map.YZ_CX_FeatureMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">YZ_CX_FeatureMap</span></code></a></p></td>
<td><p>Creates the YZ-CX Feature Map from Reference <a class="reference external" href="https://arxiv.org/abs/2108.01039v3">https://arxiv.org/abs/2108.01039v3</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../modules/generated/squlearn.feature_map.HighDimFeatureMap.html#squlearn.feature_map.HighDimFeatureMap" title="squlearn.feature_map.HighDimFeatureMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HighDimFeatureMap</span></code></a></p></td>
<td><p>The high-dimensional feature map from Reference <a class="reference external" href="https://doi.org/10.1103/PhysRevA.106.042431">https://doi.org/10.1103/PhysRevA.106.042431</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../modules/generated/squlearn.feature_map.QEKFeatureMap.html#squlearn.feature_map.QEKFeatureMap" title="squlearn.feature_map.QEKFeatureMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">QEKFeatureMap</span></code></a></p></td>
<td><p>Creates the QEK feature map as presented in Reference <a class="reference external" href="http://arxiv.org/pdf/2105.02276v1">http://arxiv.org/pdf/2105.02276v1</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../modules/generated/squlearn.feature_map.ChebyshevTower.html#squlearn.feature_map.ChebyshevTower" title="squlearn.feature_map.ChebyshevTower"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ChebyshevTower</span></code></a></p></td>
<td><p>A feature-map that is based on the Chebyshev Tower encoding.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../modules/generated/squlearn.feature_map.ChebPQC.html#squlearn.feature_map.ChebPQC" title="squlearn.feature_map.ChebPQC"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ChebPQC</span></code></a></p></td>
<td><p>Chebyshev Feature Map from Reference <a class="reference external" href="https://arxiv.org/abs/2306.01639">https://arxiv.org/abs/2306.01639</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../modules/generated/squlearn.feature_map.HZCRxCRyCRz.html#squlearn.feature_map.HZCRxCRyCRz" title="squlearn.feature_map.HZCRxCRyCRz"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HZCRxCRyCRz</span></code></a></p></td>
<td><p>Feature map with HZ encoding followed by controlled Rx, Ry Rz rotations.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../modules/generated/squlearn.feature_map.ChebRx.html#squlearn.feature_map.ChebRx" title="squlearn.feature_map.ChebRx"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ChebRx</span></code></a></p></td>
<td><p>Simple Chebyshev feature map build from  Rx gates</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../modules/generated/squlearn.feature_map.ParamZFeatureMap.html#squlearn.feature_map.ParamZFeatureMap" title="squlearn.feature_map.ParamZFeatureMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ParamZFeatureMap</span></code></a></p></td>
<td><p>Parameterized ZFeatureMap with optional CNOT gates between the default layers.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../modules/generated/squlearn.feature_map.QiskitZFeatureMap.html#squlearn.feature_map.QiskitZFeatureMap" title="squlearn.feature_map.QiskitZFeatureMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">QiskitZFeatureMap</span></code></a></p></td>
<td><p>Wrapper to use Qiskit's ZFeatureMap</p></td>
</tr>
</tbody>
</table>
<p>Feel free to contribute to sQUlearn by adding your own feature maps in a Pull Request.</p>
<p><strong>Example: Create a QEK feature map</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">squlearn.feature_map</span> <span class="kn">import</span> <span class="n">QEKFeatureMap</span>
<span class="n">pqc</span> <span class="o">=</span> <span class="n">QEKFeatureMap</span><span class="p">(</span><span class="n">num_qubits</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">num_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_layers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pqc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;mpl&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/65dc7a47f2f63baab1f7e1b13a6dcf13/feature_maps-1.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/bf6d237903c7faf912b182d00c948245/feature_maps-1.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/693d20962d0b293d4a9af9676bac6938/feature_maps-1.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/17ca91f306586f0a0423ac64313a51c7/feature_maps-1.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/feature_maps-1.png" class="plot-directive" src="../_images/feature_maps-1.png" />
</figure>
</section>
<section id="combining-quantum-feature-maps">
<h2>Combining Quantum Feature Maps<a class="headerlink" href="#combining-quantum-feature-maps" title="Permalink to this heading"></a></h2>
<p>In sQUlearn, quantum feature maps can be combined to create more sophisticated feature maps by
utilizing the <code class="docutils literal notranslate"><span class="pre">+</span></code> operation between two feature maps. However, it is important to note that
the number of qubits in both feature maps must match for successful combination.</p>
<p>When combining feature maps, the resulting feature dimension is determined by taking the maximum
value from the two feature dimensions. The parameters of the individual feature maps are
concatenated. Consequently, the total number of parameters in the combined feature map is
equal to the sum of the parameters in the two original feature maps.</p>
<p><strong>Example: combine two quantum feature maps</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">squlearn.feature_map</span> <span class="kn">import</span> <span class="n">QEKFeatureMap</span><span class="p">,</span> <span class="n">ChebPQC</span>
<span class="n">fm1</span> <span class="o">=</span> <span class="n">QEKFeatureMap</span><span class="p">(</span><span class="n">num_qubits</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">num_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_layers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fm2</span> <span class="o">=</span> <span class="n">ChebPQC</span><span class="p">(</span><span class="n">num_qubits</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">num_features</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">num_layers</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Combining both feature maps</span>
<span class="n">fm3</span> <span class="o">=</span> <span class="n">fm1</span> <span class="o">+</span> <span class="n">fm2</span>
<span class="n">fm3</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;mpl&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/5e7df0c3f1a9f865424610628e93b854/feature_maps-2.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/8c8d299535e76681dff3ae7793449d21/feature_maps-2.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/80529e0ea60eeb6cf37932be5b83d56f/feature_maps-2.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/58674ec102550fc6a2da90070159862e/feature_maps-2.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/feature_maps-2.png" class="plot-directive" src="../_images/feature_maps-2.png" />
</figure>
</section>
<section id="wrapping-qiskit-feature-maps">
<h2>Wrapping Qiskit Feature Maps<a class="headerlink" href="#wrapping-qiskit-feature-maps" title="Permalink to this heading"></a></h2>
<p>It is also possible to utilize the wrapper <a class="reference internal" href="../modules/generated/squlearn.feature_map.QiskitFeatureMap.html#squlearn.feature_map.QiskitFeatureMap" title="squlearn.feature_map.QiskitFeatureMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">QiskitFeatureMap</span></code></a> to build Feature Maps from the
<a class="reference external" href="https://qiskit.org/documentation/apidoc/circuit_library.html">Qiskit circuit library</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">squlearn.feature_map</span> <span class="kn">import</span> <span class="n">QiskitFeatureMap</span>
<span class="kn">from</span> <span class="nn">qiskit.circuit.library</span> <span class="kn">import</span> <span class="n">TwoLocal</span>
<span class="n">local</span> <span class="o">=</span> <span class="n">TwoLocal</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;ry&#39;</span><span class="p">,</span> <span class="s1">&#39;cx&#39;</span><span class="p">,</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">insert_barriers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">QiskitFeatureMap</span><span class="p">(</span><span class="n">local</span><span class="p">)</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;mpl&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/0526d95f921f6b28472b5c4a7af7e47a/feature_maps-3.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/df4782493d7475c698a19b31186c99f7/feature_maps-3.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/6b349c37e9acab36eed5a887494c45ad/feature_maps-3.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/8eec75e97108ee7bc6e60f043023ad58/feature_maps-3.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/feature_maps-3.png" class="plot-directive" src="../_images/feature_maps-3.png" />
</figure>
</section>
<section id="create-your-custom-feature-map-via-layeredfeaturemap">
<h2>Create your custom Feature Map via <a class="reference internal" href="../modules/generated/squlearn.feature_map.LayeredFeatureMap.html#squlearn.feature_map.LayeredFeatureMap" title="squlearn.feature_map.LayeredFeatureMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">LayeredFeatureMap</span></code></a><a class="headerlink" href="#create-your-custom-feature-map-via-layeredfeaturemap" title="Permalink to this heading"></a></h2>
<p>sQUlearn offers a user-friendly solution for creating custom layered feature maps effortlessly.
Layered feature maps involve the application of gates to all qubits, ensuring a comprehensive
approach. This method allows for the creation of feature maps in a structured manner,
regardless of the number of qubits involved.
Two-qubit gates are applied either in a nearest neighbor fashion or by entangling all qubits.
You can construct the layered feature map using either a Qiskit Quantum circuit-inspired approach
or by providing a string using the
<a class="reference internal" href="../modules/generated/squlearn.feature_map.LayeredFeatureMap.html#squlearn.feature_map.LayeredFeatureMap.from_string" title="squlearn.feature_map.LayeredFeatureMap.from_string"><code class="xref py py-meth docutils literal notranslate"><span class="pre">LayeredFeatureMap.from_string()</span></code></a>
method. For detailed instructions on the string format, please refer to the documentation of
the <a class="reference internal" href="../modules/generated/squlearn.feature_map.LayeredFeatureMap.html#squlearn.feature_map.LayeredFeatureMap" title="squlearn.feature_map.LayeredFeatureMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">LayeredFeatureMap</span></code></a> class.</p>
<p><strong>Example: Create your custom layered feature map</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">squlearn.feature_map</span> <span class="kn">import</span> <span class="n">LayeredFeatureMap</span>
<span class="kn">from</span> <span class="nn">squlearn.feature_map.layered_feature_map</span> <span class="kn">import</span> <span class="n">Layer</span>
<span class="n">feature_map</span> <span class="o">=</span> <span class="n">LayeredFeatureMap</span><span class="p">(</span><span class="n">num_qubits</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">num_features</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">feature_map</span><span class="o">.</span><span class="n">H</span><span class="p">()</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">Layer</span><span class="p">(</span><span class="n">feature_map</span><span class="p">)</span>
<span class="n">layer</span><span class="o">.</span><span class="n">Rz</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">layer</span><span class="o">.</span><span class="n">Ry</span><span class="p">(</span><span class="s2">&quot;p&quot;</span><span class="p">)</span>
<span class="n">layer</span><span class="o">.</span><span class="n">cx_entangling</span><span class="p">(</span><span class="s2">&quot;NN&quot;</span><span class="p">)</span>
<span class="n">feature_map</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span><span class="n">num_layers</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">feature_map</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;mpl&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/393ef4dda6e280e4025c593f6f312012/feature_maps-4.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/e2b0848e8ef92a95244740293ea48774/feature_maps-4.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/fda356dd8e484dfa94e10a110a832f28/feature_maps-4.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/6b3f254e5ba1b480c4b354afb55071a5/feature_maps-4.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/feature_maps-4.png" class="plot-directive" src="../_images/feature_maps-4.png" />
</figure>
<p><strong>Example: Create your custom layered feature map from a string</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">squlearn.feature_map</span> <span class="kn">import</span> <span class="n">LayeredFeatureMap</span>
<span class="n">feature_map</span> <span class="o">=</span> <span class="n">LayeredFeatureMap</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span>
   <span class="s2">&quot;Ry(p)-3[Rx(p,x;=y*np.arccos(x),{y,x})-crz(p)]-Ry(p)&quot;</span><span class="p">,</span> <span class="n">num_qubits</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">num_features</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_layers</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>
<span class="n">feature_map</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;mpl&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/7bd7e84d5d3d0e194ce39e95d339fbfb/feature_maps-5.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/23d7a5526168810ba31677eb3a405459/feature_maps-5.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/085fb4f0e7f67ca7a3ae5372c7f63281/feature_maps-5.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/3f45782860e91e8bbce53db18acb6116/feature_maps-5.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/feature_maps-5.png" class="plot-directive" src="../_images/feature_maps-5.png" />
</figure>
</section>
<section id="pruning-of-quantum-feature-maps">
<h2>Pruning of Quantum Feature Maps<a class="headerlink" href="#pruning-of-quantum-feature-maps" title="Permalink to this heading"></a></h2>
<p>It is also possible to remove parameterized gates from a quantum feature map by using the
<a class="reference internal" href="../modules/generated/squlearn.feature_map.PrunedFeatureMap.html#squlearn.feature_map.PrunedFeatureMap" title="squlearn.feature_map.PrunedFeatureMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrunedFeatureMap</span></code></a> class.
This class accepts a quantum feature map as input and removes the parameterized gates
from the feature map for the parameters which indices are specified in the supplied list.
The pruned feature map automatically adjusts the number of parameters and features.</p>
<p>Furthermore it is possible to determine the redundant parameters in feature map automatically.
The algorithm is based on <a class="reference external" href="https://doi.org/10.1103/PRXQuantum.2.040309">https://doi.org/10.1103/PRXQuantum.2.040309</a> and is based on evaluating
the Quantum Fisher Information Matrix (QFIM) of the feature map.</p>
<p>sQUlearn features a fully automated pruning algorithm which can be used by calling the routine
<a class="reference internal" href="../modules/generated/squlearn.feature_map.automated_pruning.html#squlearn.feature_map.automated_pruning" title="squlearn.feature_map.automated_pruning"><code class="xref py py-meth docutils literal notranslate"><span class="pre">automated_pruning()</span></code></a> that returns a pruned feature map without the redundant parameters.</p>
<p><strong>Example: Pruning a feature map with redundant parameters</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">squlearn.feature_map</span> <span class="kn">import</span> <span class="n">LayeredFeatureMap</span><span class="p">,</span> <span class="n">automated_pruning</span>
<span class="kn">from</span> <span class="nn">squlearn.util</span> <span class="kn">import</span> <span class="n">Executor</span>
<span class="n">feature_map</span> <span class="o">=</span> <span class="n">LayeredFeatureMap</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;Rz(p)-Ry(p)-Z-Ry(p)-Rz(p)&quot;</span><span class="p">,</span> <span class="n">num_qubits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_features</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">pruned_feature_map</span> <span class="o">=</span> <span class="n">automated_pruning</span><span class="p">(</span><span class="n">feature_map</span><span class="p">,</span> <span class="n">Executor</span><span class="p">(</span><span class="s2">&quot;statevector_simulator&quot;</span><span class="p">))</span>
<span class="n">pruned_feature_map</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;mpl&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/c3b9632ef01388e8e7c801cac68ab5f2/feature_maps-6.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/fc3662dbacb80444c6b91ed20ef93e8c/feature_maps-6.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/9ec5930daec2e5faac77286c013fe7e2/feature_maps-6.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/1bcb03efb106be952bd52bbf558b08e6/feature_maps-6.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/feature_maps-6.png" class="plot-directive" src="../_images/feature_maps-6.png" />
</figure>
</section>
<section id="different-quantum-feature-maps-via-featuremapderivatives">
<h2>Different Quantum Feature Maps via <a class="reference internal" href="../modules/generated/squlearn.feature_map.FeatureMapDerivatives.html#squlearn.feature_map.FeatureMapDerivatives" title="squlearn.feature_map.FeatureMapDerivatives"><code class="xref py py-class docutils literal notranslate"><span class="pre">FeatureMapDerivatives</span></code></a><a class="headerlink" href="#different-quantum-feature-maps-via-featuremapderivatives" title="Permalink to this heading"></a></h2>
<p>The calculation of derivatives for quantum feature maps is often essential in training a
Quantum Machine Learning model. In sQUlearn, we offer a straightforward approach to compute
these derivatives using the <a class="reference internal" href="../modules/generated/squlearn.feature_map.FeatureMapDerivatives.html#squlearn.feature_map.FeatureMapDerivatives" title="squlearn.feature_map.FeatureMapDerivatives"><code class="xref py py-class docutils literal notranslate"><span class="pre">FeatureMapDerivatives</span></code></a> class.
This class accepts an existing quantum feature map as input and generates derivatives of the
feature map with respect to its parameters or features. The derivative circuits are generated
by leveraging the parameter-shift rule and are cached for future use.
To obtain the derivative, you have two options. Firstly, you can use the function
<a class="reference internal" href="../modules/generated/squlearn.feature_map.FeatureMapDerivatives.html#squlearn.feature_map.FeatureMapDerivatives.get_derivative" title="squlearn.feature_map.FeatureMapDerivatives.get_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_derivative()</span></code></a>
by supplying a string (a list of available strings can be found in the
<a class="reference internal" href="../modules/generated/squlearn.feature_map.FeatureMapDerivatives.html#squlearn.feature_map.FeatureMapDerivatives" title="squlearn.feature_map.FeatureMapDerivatives"><code class="xref py py-class docutils literal notranslate"><span class="pre">FeatureMapDerivatives</span></code></a> class). Alternatively, you can provide a tuple containing
the parameter (or feature) vector. Additional parameters can be included in the tuple to
obtain arbitrary derivatives.
Currently, the derivatives are returned as a Qiskit Opflow object, but will be converted to
a custom format in the future.</p>
<p><strong>Example: Obtain the derivative of a QEK feature map</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">squlearn.feature_map</span> <span class="kn">import</span> <span class="n">QEKFeatureMap</span><span class="p">,</span> <span class="n">FeatureMapDerivatives</span>
<span class="n">fm</span> <span class="o">=</span> <span class="n">QEKFeatureMap</span><span class="p">(</span><span class="n">num_qubits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_layers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fm_deriv</span> <span class="o">=</span> <span class="n">FeatureMapDerivatives</span><span class="p">(</span><span class="n">fm</span><span class="p">)</span>
<span class="n">grad_from_string</span> <span class="o">=</span> <span class="n">fm_deriv</span><span class="o">.</span><span class="n">get_derivative</span><span class="p">(</span><span class="s2">&quot;dp&quot;</span><span class="p">)</span>
<span class="n">grad_from_tuple</span> <span class="o">=</span> <span class="n">fm_deriv</span><span class="o">.</span><span class="n">get_derivative</span><span class="p">((</span><span class="n">fm_deriv</span><span class="o">.</span><span class="n">parameter_vector</span><span class="p">,))</span>
</pre></div>
</div>
</section>
<section id="transpile-quantum-feature-maps-via-transpiledfeaturemap">
<h2>Transpile Quantum Feature Maps via <a class="reference internal" href="../modules/generated/squlearn.feature_map.TranspiledFeatureMap.html#squlearn.feature_map.TranspiledFeatureMap" title="squlearn.feature_map.TranspiledFeatureMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">TranspiledFeatureMap</span></code></a><a class="headerlink" href="#transpile-quantum-feature-maps-via-transpiledfeaturemap" title="Permalink to this heading"></a></h2>
<p>To transpile a quantum feature map, you can leverage the functionality provided by the
<a class="reference internal" href="../modules/generated/squlearn.feature_map.TranspiledFeatureMap.html#squlearn.feature_map.TranspiledFeatureMap" title="squlearn.feature_map.TranspiledFeatureMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">TranspiledFeatureMap</span></code></a> class. By utilizing this class, you can input an existing
quantum feature map and have its circuit transpiled according to the specified backend and
transpiler settings, which are the same settings used in Qiskit.
The transpiled feature map is internally employed in the QNN program and projected kernels,
where it is employed internally.</p>
<p><strong>Example: Transpile a existing Feature Map to a fake backend</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">squlearn.feature_map</span> <span class="kn">import</span> <span class="n">TranspiledFeatureMap</span><span class="p">,</span><span class="n">ChebRx</span>
<span class="kn">from</span> <span class="nn">qiskit.providers.fake_provider</span> <span class="kn">import</span> <span class="n">FakeManilaV2</span>

<span class="n">fm</span> <span class="o">=</span> <span class="n">TranspiledFeatureMap</span><span class="p">(</span><span class="n">ChebRx</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">backend</span><span class="o">=</span><span class="n">FakeManilaV2</span><span class="p">(),</span><span class="n">initial_layout</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">fm</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;mpl&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/737b38da517116f1d09685ae2fdaca60/feature_maps-7.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="../_downloads/eeca7bc0c755adfe18ee8e4133702941/feature_maps-7.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/b37d18ebd8a847abacf3c31f62c1390e/feature_maps-7.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/61469452d6aea299d876ecd5f99e7391/feature_maps-7.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/feature_maps-7.png" class="plot-directive" src="../_images/feature_maps-7.png" />
</figure>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="operators.html" class="btn btn-neutral float-left" title="Operators for expectation values" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="kernel_methods.html" class="btn btn-neutral float-right" title="Quantum Kernel Methods" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Fraunhofer IPA.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>