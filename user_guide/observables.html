<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Observables for expectation values &mdash; sQUlearn 0.8.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
      <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css?v=572af1d6" />
      <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=a63e3025" />

  
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="canonical" href="https://squlearn.github.io/user_guide/observables.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=dbee5847"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/thebelab-helper.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Quantum Encoding Circuits" href="encoding_circuits.html" />
    <link rel="prev" title="The Executor Class" href="executor.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.8.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install/install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="user_guide_index.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="executor.html">The Executor Class</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Observables for expectation values</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#implemented-observables">Implemented observables.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#custom-observables">Custom observables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mapping-observables-to-real-qubits">Mapping observables to real qubits</a></li>
<li class="toctree-l3"><a class="reference internal" href="#derivatives-of-the-observable">Derivatives of the observable</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="encoding_circuits.html">Quantum Encoding Circuits</a></li>
<li class="toctree-l2"><a class="reference internal" href="kernel_methods.html">Quantum Kernel Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="quantum_neural_networks.html">Quantum Neural Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="quantum_reservoir_computing.html">Quantum Reservoir Computing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules/classes.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/examples_index.html">Examples</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">sQUlearn</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="user_guide_index.html">User Guide</a></li>
      <li class="breadcrumb-item active">Observables for expectation values</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/user_guide/observables.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="observables-for-expectation-values">
<span id="user-guide-observables"></span><h1>Observables for expectation values<a class="headerlink" href="#observables-for-expectation-values" title="Link to this heading"></a></h1>
<p>Observables play a crucial role in computing the expectation value in conjunction with a
wave function. Currently, observables constructed purely from the Pauli group
<span class="math notranslate nohighlight">\(\{\hat{X},\hat{Y},\hat{Z},\hat{I}\}\)</span> are supported. In the context of sQUlearn,
observables are mandatory inputs for Quantum Neural Networks (QNNs) and can be
employed in the Projected Quantum Kernel program.
All operators follow the Base Class <code class="xref py py-class docutils literal notranslate"><span class="pre">ObservableBase</span></code>. sQulearn features several
predefined observables, but it is also possible to simply construct custom observables.</p>
<section id="implemented-observables">
<h2>Implemented observables.<a class="headerlink" href="#implemented-observables" title="Link to this heading"></a></h2>
<p>The following predefined observables are available in the module <a class="reference internal" href="../modules/classes.html#module-squlearn.observables" title="squlearn.observables"><code class="xref py py-class docutils literal notranslate"><span class="pre">squlearn.observables</span></code></a>:</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../modules/generated/squlearn.observables.SinglePauli.html#squlearn.observables.SinglePauli" title="squlearn.observables.SinglePauli"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SinglePauli</span></code></a></p></td>
<td><p>Observable constructed from a single Pauli operator of a single Qubit.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../modules/generated/squlearn.observables.SummedPaulis.html#squlearn.observables.SummedPaulis" title="squlearn.observables.SummedPaulis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SummedPaulis</span></code></a></p></td>
<td><p>Observable for summation of single Pauli operators.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../modules/generated/squlearn.observables.SingleProbability.html#squlearn.observables.SingleProbability" title="squlearn.observables.SingleProbability"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SingleProbability</span></code></a></p></td>
<td><p>Observable for measuring the probability of being in state 0 or 1 of a specified qubit.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../modules/generated/squlearn.observables.SummedProbabilities.html#squlearn.observables.SummedProbabilities" title="squlearn.observables.SummedProbabilities"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SummedProbabilities</span></code></a></p></td>
<td><p>Observable for summing single Qubit probabilities of binary states.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../modules/generated/squlearn.observables.IsingHamiltonian.html#squlearn.observables.IsingHamiltonian" title="squlearn.observables.IsingHamiltonian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IsingHamiltonian</span></code></a></p></td>
<td><p>Implementation of Ising type Hamiltonians.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../modules/generated/squlearn.observables.CustomObservable.html#squlearn.observables.CustomObservable" title="squlearn.observables.CustomObservable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CustomObservable</span></code></a></p></td>
<td><p>Class for defining a custom observable.</p></td>
</tr>
</tbody>
</table>
<p>The observables are simply constructed by initializing the associated class.</p>
<p><strong>Example: Summed Pauli observable</strong></p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">squlearn.observables</span> <span class="kn">import</span> <span class="n">SummedPaulis</span>

<span class="n">op</span> <span class="o">=</span> <span class="n">SummedPaulis</span><span class="p">(</span><span class="n">num_qubits</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>SparsePauliOp([&#39;II&#39;, &#39;IZ&#39;, &#39;ZI&#39;],
              coeffs=[ParameterExpression(1.0*p[0]), ParameterExpression(1.0*p[1]),
 ParameterExpression(1.0*p[2])])
</pre></div>
</div>
</div>
</div>
</section>
<section id="custom-observables">
<h2>Custom observables<a class="headerlink" href="#custom-observables" title="Link to this heading"></a></h2>
<p>sQUlearn features several options to construct custom observables.
With the class <a class="reference internal" href="../modules/generated/squlearn.observables.CustomObservable.html#squlearn.observables.CustomObservable" title="squlearn.observables.CustomObservable"><code class="xref py py-class docutils literal notranslate"><span class="pre">CustomObservable</span></code></a>, it is possible to construct observables from a string
containing the letters of the Pauli matrices (<code class="docutils literal notranslate"><span class="pre">&quot;X&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Y&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Z&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;I&quot;</span></code>).
The resulting observable can be multiplied by a parameter by setting <code class="docutils literal notranslate"><span class="pre">parameterized=True</span></code>.
Furthermore, observables can be added by <code class="docutils literal notranslate"><span class="pre">+</span></code> or multiplied by <code class="docutils literal notranslate"><span class="pre">*</span></code> with each other.
This allows the creation of arbitrary observables.</p>
<p><strong>Example: Custom observable</strong></p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">squlearn.observables</span> <span class="kn">import</span> <span class="n">CustomObservable</span>

<span class="n">ob1</span> <span class="o">=</span> <span class="n">CustomObservable</span><span class="p">(</span><span class="n">num_qubits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">operator_string</span><span class="o">=</span><span class="s2">&quot;IX&quot;</span><span class="p">,</span><span class="n">parameterized</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ob2</span> <span class="o">=</span> <span class="n">CustomObservable</span><span class="p">(</span><span class="n">num_qubits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">operator_string</span><span class="o">=</span><span class="s2">&quot;ZY&quot;</span><span class="p">,</span><span class="n">parameterized</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">added_ob</span> <span class="o">=</span> <span class="n">ob1</span> <span class="o">+</span> <span class="n">ob2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Added observable:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">added_ob</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">squared_ob</span> <span class="o">=</span> <span class="n">added_ob</span><span class="o">*</span><span class="n">added_ob</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Squared observable:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">squared_ob</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Added observable:
 SparsePauliOp([&#39;IX&#39;, &#39;ZY&#39;],
              coeffs=[ParameterExpression(1.0*p[0]), ParameterExpression(1.0*p[1])]) 


Squared observable:
 SparsePauliOp([&#39;II&#39;, &#39;ZZ&#39;],
              coeffs=[ParameterExpression(1.0*p[0]**2 + 1.0*p[1]**2), ParameterExpression(0)])
</pre></div>
</div>
</div>
</div>
<p><strong>Example: More complex custom observable</strong></p>
<p>It is also possible to construct more complex observables by supplying a list of strings
containing the Pauli matrices. The observable is then constructed by adding the single observables
together.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">squlearn.observables</span> <span class="kn">import</span> <span class="n">CustomObservable</span>

<span class="c1"># It is also possible to add trainable parameters:</span>
<span class="n">ob</span> <span class="o">=</span> <span class="n">CustomObservable</span><span class="p">(</span><span class="n">num_qubits</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">operator_string</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ZIZZ&quot;</span><span class="p">,</span> <span class="s2">&quot;XIXI&quot;</span><span class="p">],</span> <span class="n">parameterized</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Custom observable with multiple operators:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">ob</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Custom observable with multiple operators:
 SparsePauliOp([&#39;ZIZZ&#39;, &#39;XIXI&#39;],
              coeffs=[ParameterExpression(1.0*p[0]), ParameterExpression(1.0*p[1])])
</pre></div>
</div>
</div>
</div>
<p>Note that in Qiskit, the qubits are counted from the right to the left as in the computational
basis!</p>
</section>
<section id="mapping-observables-to-real-qubits">
<h2>Mapping observables to real qubits<a class="headerlink" href="#mapping-observables-to-real-qubits" title="Link to this heading"></a></h2>
<p>When running on a backend, the number of physical qubits may change
from the number of qubits the definition of the observable.
If it is necessary, it is possible to adjust the observable to the physical qubits.
This is achieved by providing a map from the qubits of the observable to the
physical qubits utilized for example in the feature map via the function <code class="xref py py-meth docutils literal notranslate"><span class="pre">set_qubit_map()</span></code>.
The map can be for example obtained in the transpiled encoding circuit.</p>
<p><strong>Example: Use the mapping from the transpiled encoding circuit</strong></p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">squlearn.encoding_circuit</span> <span class="kn">import</span> <span class="n">ChebyshevRx</span><span class="p">,</span><span class="n">TranspiledEncodingCircuit</span>
<span class="kn">from</span> <span class="nn">squlearn.observables</span> <span class="kn">import</span> <span class="n">SummedPaulis</span>
<span class="kn">from</span> <span class="nn">qiskit_ibm_runtime.fake_provider</span> <span class="kn">import</span> <span class="n">FakeManilaV2</span>
<span class="n">fm</span> <span class="o">=</span> <span class="n">TranspiledEncodingCircuit</span><span class="p">(</span><span class="n">ChebyshevRx</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">backend</span><span class="o">=</span><span class="n">FakeManilaV2</span><span class="p">(),</span><span class="n">initial_layout</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">ob</span> <span class="o">=</span> <span class="n">SummedPaulis</span><span class="p">(</span><span class="n">num_qubits</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">op_str</span><span class="o">=</span><span class="s2">&quot;Z&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Observable before mapping:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">ob</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ob</span><span class="o">.</span><span class="n">set_map</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">qubit_map</span><span class="p">,</span> <span class="n">fm</span><span class="o">.</span><span class="n">num_physical_qubits</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Observable after mapping:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">ob</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Observable before mapping:
 SparsePauliOp([&#39;III&#39;, &#39;IIZ&#39;, &#39;IZI&#39;, &#39;ZII&#39;],
              coeffs=[ParameterExpression(1.0*p[0]), ParameterExpression(1.0*p[1]),
 ParameterExpression(1.0*p[2]), ParameterExpression(1.0*p[3])]) 


Observable after mapping:
 SparsePauliOp([&#39;IIIII&#39;, &#39;IIIIZ&#39;, &#39;IIIZI&#39;, &#39;ZIIII&#39;],
              coeffs=[ParameterExpression(1.0*p[0]), ParameterExpression(1.0*p[1]),
 ParameterExpression(1.0*p[2]), ParameterExpression(1.0*p[3])])
</pre></div>
</div>
</div>
</div>
</section>
<section id="derivatives-of-the-observable">
<h2>Derivatives of the observable<a class="headerlink" href="#derivatives-of-the-observable" title="Link to this heading"></a></h2>
<p>In sQUlearn it is also possible to calculate derivatives of observables
as for example needed during the training of the QNN.
This is possible with the class <a class="reference internal" href="../modules/generated/squlearn.observables.observable_derivatives.ObservableDerivatives.html#squlearn.observables.observable_derivatives.ObservableDerivatives" title="squlearn.observables.observable_derivatives.ObservableDerivatives"><code class="xref py py-class docutils literal notranslate"><span class="pre">ObservableDerivatives</span></code></a>.
The derivatives are calculated with respect to the parameters of the observable.</p>
<p><strong>Example: first-order derivatives of the Ising Hamiltonian</strong></p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">squlearn.observables</span> <span class="kn">import</span> <span class="n">IsingHamiltonian</span>
<span class="kn">from</span> <span class="nn">squlearn.observables.observable_derivatives</span> <span class="kn">import</span> <span class="n">ObservableDerivatives</span>
<span class="n">ob</span> <span class="o">=</span> <span class="n">IsingHamiltonian</span><span class="p">(</span><span class="n">num_qubits</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Observable:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ob</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Gradient of the observable:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ObservableDerivatives</span><span class="p">(</span><span class="n">ob</span><span class="p">)</span><span class="o">.</span><span class="n">get_derivative</span><span class="p">(</span><span class="s2">&quot;dop&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Observable:
 SparsePauliOp([&#39;III&#39;, &#39;IIZ&#39;, &#39;IZI&#39;, &#39;ZII&#39;, &#39;IZZ&#39;, &#39;ZIZ&#39;, &#39;ZZI&#39;],
              coeffs=[ParameterExpression(1.0*p[0]), ParameterExpression(1.0*p[1]),
 ParameterExpression(1.0*p[2]), ParameterExpression(1.0*p[3]),
 ParameterExpression(1.0*p[4]), ParameterExpression(1.0*p[5]),
 ParameterExpression(1.0*p[6])]) 


Gradient of the observable:
 [1.0*SparsePauliOp([&#39;III&#39;],
              coeffs=[1.+0.j]), 1.0*SparsePauliOp([&#39;IIZ&#39;],
              coeffs=[1.+0.j]), 1.0*SparsePauliOp([&#39;IZI&#39;],
              coeffs=[1.+0.j]), 1.0*SparsePauliOp([&#39;ZII&#39;],
              coeffs=[1.+0.j]), 1.0*SparsePauliOp([&#39;IZZ&#39;],
              coeffs=[1.+0.j]), 1.0*SparsePauliOp([&#39;ZIZ&#39;],
              coeffs=[1.+0.j]), 1.0*SparsePauliOp([&#39;ZZI&#39;],
              coeffs=[1.+0.j])]
</pre></div>
</div>
</div>
</div>
<p><strong>Example: higher-order derivative of the cubed SummedPaulis observable</strong></p>
<p>Furthermore, arbitrary derivatives can be computed by supplying a tuple, although the
higher-order derivatives are zero for linear parameters.
To achieve this, the function <a class="reference internal" href="../modules/generated/squlearn.observables.observable_derivatives.ObservableDerivatives.html#squlearn.observables.observable_derivatives.ObservableDerivatives.get_derivative" title="squlearn.observables.observable_derivatives.ObservableDerivatives.get_derivative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ObservableDerivatives.get_derivative()</span></code></a> can be used with a tuple
of parameters <a class="reference internal" href="../modules/generated/squlearn.observables.observable_derivatives.ObservableDerivatives.html#squlearn.observables.observable_derivatives.ObservableDerivatives.parameter_vector" title="squlearn.observables.observable_derivatives.ObservableDerivatives.parameter_vector"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ObservableDerivatives.parameter_vector()</span></code></a>.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">squlearn.observables</span> <span class="kn">import</span> <span class="n">SummedPaulis</span>
<span class="kn">from</span> <span class="nn">squlearn.observables.observable_derivatives</span> <span class="kn">import</span> <span class="n">ObservableDerivatives</span>

<span class="c1"># Build cubed SummedPaulis observable</span>
<span class="n">op</span> <span class="o">=</span> <span class="n">SummedPaulis</span><span class="p">(</span><span class="n">num_qubits</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">op3</span> <span class="o">=</span> <span class="n">op</span><span class="o">*</span><span class="n">op</span><span class="o">*</span><span class="n">op</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cubed operator:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">op3</span><span class="p">)</span>

<span class="c1"># Get the Hessian from a tuple</span>
<span class="n">deriv</span> <span class="o">=</span> <span class="n">ObservableDerivatives</span><span class="p">(</span><span class="n">op3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Second-order derivative w.r.t. p[0]:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
         <span class="n">deriv</span><span class="o">.</span><span class="n">get_derivative</span><span class="p">((</span><span class="n">deriv</span><span class="o">.</span><span class="n">parameter_vector</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">deriv</span><span class="o">.</span><span class="n">parameter_vector</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Cubed operator:
 SparsePauliOp([&#39;II&#39;, &#39;IZ&#39;, &#39;ZI&#39;, &#39;ZZ&#39;],
              coeffs=[ParameterExpression(2.0*p[0]*p[1]*p[4] + 2.0*p[0]*p[2]*p[5] + 1.0*p[3]*(1.0*p[0]**2 + 1.0*p[1]**2 + 1.0*p[2]**2)),
 ParameterExpression(2.0*p[0]*p[1]*p[3] + 2.0*p[1]*p[2]*p[5] + 1.0*p[4]*(1.0*p[0]**2 + 1.0*p[1]**2 + 1.0*p[2]**2)),
 ParameterExpression(2.0*p[0]*p[2]*p[3] + 2.0*p[1]*p[2]*p[4] + 1.0*p[5]*(1.0*p[0]**2 + 1.0*p[1]**2 + 1.0*p[2]**2)),
 ParameterExpression(2.0*p[0]*p[1]*p[5] + 2.0*p[0]*p[2]*p[4] + 2.0*p[1]*p[2]*p[3])])
Second-order derivative w.r.t. p[0]:
 [1.0*[1.0*SparsePauliOp([&#39;II&#39;, &#39;IZ&#39;, &#39;ZI&#39;],
              coeffs=[ParameterExpression(2.0*p_op[3]), ParameterExpression(2.0*p_op[4]),
 ParameterExpression(2.0*p_op[5])])]]
</pre></div>
</div>
</div>
</div>
<p><strong>Example: Squared summed Pauli Observable</strong></p>
<p>It is also possible to calculate the squared observable, which is needed for the
calculation of the variance of the observable.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">squlearn.observables</span> <span class="kn">import</span> <span class="n">SummedPaulis</span>
<span class="kn">from</span> <span class="nn">squlearn.observables.observable_derivatives</span> <span class="kn">import</span> <span class="n">ObservableDerivatives</span>
<span class="n">op</span> <span class="o">=</span> <span class="n">SummedPaulis</span><span class="p">(</span><span class="n">num_qubits</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ObservableDerivatives</span><span class="p">(</span><span class="n">op</span><span class="p">)</span><span class="o">.</span><span class="n">get_operator_squared</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>SparsePauliOp([&#39;III&#39;, &#39;IIZ&#39;, &#39;IZI&#39;, &#39;ZII&#39;, &#39;IZZ&#39;, &#39;ZIZ&#39;, &#39;ZZI&#39;],
              coeffs=[ParameterExpression(1.0*p_op[0]**2 + 1.0*p_op[1]**2 + 1.0*p_op[2]**2 + 1.0*p_op[3]**2),
 ParameterExpression(2.0*p_op[0]*p_op[1]),
 ParameterExpression(2.0*p_op[0]*p_op[2]),
 ParameterExpression(2.0*p_op[0]*p_op[3]),
 ParameterExpression(2.0*p_op[1]*p_op[2]),
 ParameterExpression(2.0*p_op[1]*p_op[3]),
 ParameterExpression(2.0*p_op[2]*p_op[3])])
</pre></div>
</div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="executor.html" class="btn btn-neutral float-left" title="The Executor Class" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="encoding_circuits.html" class="btn btn-neutral float-right" title="Quantum Encoding Circuits" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Fraunhofer IPA.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>